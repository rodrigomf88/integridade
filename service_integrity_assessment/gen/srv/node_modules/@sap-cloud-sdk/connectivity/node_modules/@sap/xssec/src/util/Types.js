/** @typedef {import('crypto').X509Certificate} X509Certificate */

// Credentials
/**
 * @typedef {Object} ServiceCredentials
 * @property {String} clientid
 * @property {String} url
 * @property {String} [certificate] PEM-encoded client certificate
 * @property {String} [key] PEM-encoded client key
 */

/**
 * @typedef {Object} IdentityServiceCredentials
 * @property {String} app_tid tenant
 */

/**
 * @typedef {Object} XsuaaServiceCredentials
 * @property {String} xsappname
 * @property {String} uaadomain domain of service
*/

/**
 * @typedef {Object} XsaServiceCredentials
 * @property {String} xsappname
 */

/**
 * @typedef {Object} UaaServiceCredentials
 * @property {String} uaadomain domain of service
 */


// Service configurations
/**
 * @typedef {Object} ServiceConfig
 * @property {Object} [endpoints] key/value object whose entries override default endpoints of service
 */

/**
 * @typedef {Object} IdentityServiceConfig
 * @property {Object} [validation] configures different kinds of validation
 * @property {Object} [validation.x5t] configures x5t validation
 * @property {Boolean} [validation.x5t.enabled=false] enables x5t validation
 * @property {Object} [validation.proofToken] configures proof token validation
 * @property {Boolean} [validation.proofToken.enabled=false] enables proof token validation
 * @property {Array} [extensions] list of security context extensions that implement a context => Promise\<void\> function called extendSecurityContext
 */




// SecurityContext configurations
/**
 * @typedef {Object} SecurityContextConfig
 * @property {String} [jwt] jwt token used to build the context
 * @property {String} [clientCertificatePem] client certificate in PEM format
 * @property {X509Certificate} [clientCertificate] parsed client certificate which will be automatically created from clientCertificatePem
 * @property {String} [correlationId] correlation id that will be sent along with external requests
 * @property {Request} [req] request object from which the jwt and additional information, such as a correlation id and the forwarded client certificate, will be extracted if not provided directly
 */



// Token fetch options
/** 
 * @typedef {Object} TokenFetchOptions
 * @property {String} correlationId correlationId to correlate log entries with the request
 * @property {number} timeout request timeout in ms 
 * @property {"jwt"|"opaque"} token_format "jwt" or "opaque" (Default: "jwt")
*/

/** 
 * @typedef {Object} IdentityServiceTokenFetchOptions
 * @property {String} app_tid can be used to override the app_tid from credentials for this token fetch
 * @property {String|String[]} resource name (or array of names) of API dependency to another application that shall be consumed with this token in the format urn:sap:identity:application:provider:name:<dependencyName>
*/

/** 
 * @typedef {Object} XsuaaTokenFetchOptions
 * @property {String[]} scope requested scope of token
 * @property {String} tenant (aka subdomain) the subdomain of a tenant on the same subaccount from which to fetch a token. Note that this parameter does NOT accept a tenant ID. To pass a zone ID, use the zid parameter instead.
 * @property {String} zid the zone id from which to fetch a token
 * @property {object} authorities additional authorities that can be freely chosen during token fetch that will be put into the token under az_attr claim (see https://github.com/cloudfoundry/uaa/blob/24c0c23fa36d7c604e365e1be4df658d55dcb211/docs/UAA-APIs.rst#support-for-additional-authorization-attributes)
*/

/**
 * @typedef {"client_credentials"|"password"|"urn:ietf:params:oauth:grant-type:jwt-bearer"} GrantType
*/



// Token fetch responses
/**
 * @typedef {Object} TokenFetchResponse
 * @property {String} access_token access token as JWT
 * @property {number} expires_in number of seconds until the access token expires
 * @property {String} token_type
*/

/**
 * @typedef {Object} IdTokenFetchResponse
 * @property {String} id_token - ID token as JWT
*/

/**
 * @typedef {Object} RefreshableTokenFetchResponse
 * @property {String} refresh_token
*/

/** @typedef {TokenFetchResponse & IdTokenFetchResponse & RefreshableTokenFetchResponse} IdentityServicePasswordTokenFetchResponse */
/** @typedef {TokenFetchResponse & IdTokenFetchResponse & RefreshableTokenFetchResponse} IdentityServiceJwtBearerTokenFetchResponse */




// JWT structure
/**
 * @typedef {object} JwtHeader
 * @property {string} [kid];
 * @property {string} [alg];
 */

/**
 * @typedef {object} JwtPayload
 * Standard claims https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.
 * @property {string} [iss];
 * @property {string} [sub];
 * @property {string | string[]} [aud];
 * @property {number} [exp];
 * @property {number} [nbf];
 * @property {number} [iat];
 * @property {string} [jti];
 */



module.exports = {};